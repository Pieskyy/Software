<!DOCTYPE html>
<html>
<head>
    <title>Clash Royale Cards</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <h1>Clash Royale Cards</h1>

    <!-- Search & Sort Controls -->
    <div class="controls">
        <input type="text" id="searchInput" placeholder="Search cards..." onkeyup="filterCards()">
        <select id="sortSelect" onchange="sortCards()">
            <option value="name">Sort by Name (A–Z)</option>
            <option value="health">Sort by Health (High → Low)</option>
            <option value="damage">Sort by Damage (High → Low)</option>
            <option value="elixir">Sort by Elixir Cost (Low → High)</option>
        </select>
    </div>

    <!-- Card Grid -->
    <div class="grid" id="cardGrid">
        {% for card in cards %}
        <div class="card" 
             data-name="{{ card['name'] | lower }}" 
             data-health="{{ card['health'] | default(0) }}" 
             data-damage="{{ card['damage'] | default(0) }}" 
             data-elixir="{{ card['elixir'] | default(0) }}">
            <a href="{{ url_for('card_detail', card_id=card['id']) }}">
                <img src="{{ '/' + card['image'] }}" alt="{{ card['name'] }}">
                <p>{{ card['name'] }}</p>
            </a>
        </div>
        {% endfor %}
    </div>

    <!-- JavaScript for Search & Sort -->
    <script>
        function filterCards() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                const name = card.dataset.name;
                card.style.display = name.includes(query) ? '' : 'none';
            });
        }

        function sortCards() {
            const sortValue = document.getElementById('sortSelect').value;
            const grid = document.getElementById('cardGrid');
            const cards = Array.from(grid.children);

            cards.sort((a, b) => {
                if (sortValue === 'name') {
                    return a.dataset.name.localeCompare(b.dataset.name);
                } else if (sortValue === 'health') {
                    return b.dataset.health - a.dataset.health;
                } else if (sortValue === 'damage') {
                    return b.dataset.damage - a.dataset.damage;
                } else if (sortValue === 'elixir') {
                    return a.dataset.elixir - b.dataset.elixir;
                }
            });

            // Re-append sorted cards
            cards.forEach(card => grid.appendChild(card));
        }
    </script>
</body>
</html>
